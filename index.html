<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secret Quiz - Discover Your Wild Side</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; background: #121212; color: #fff; }
        .container { max-width: 500px; margin: 20px auto; background: #222; padding: 20px; border-radius: 10px; }
        .question { margin-bottom: 15px; font-size: 18px; }
        .options { display: flex; flex-direction: column; }
        button { padding: 10px; margin: 5px; background: #ff4757; border: none; color: #fff; border-radius: 5px; cursor: pointer; }
        .hidden { display: none; }
        input { width: 100%; padding: 8px; margin-top: 10px; border-radius: 5px; }
    </style>
</head>
<body>
    <div class="container">
        <h2>🔥 Secret Quiz - How Wild Are You? 🔥</h2>
        <div id="quiz"></div>
        <div id="result" class="hidden">
            <h3>Your score is being calculated...</h3>
            <p>Want your full secret breakdown? Enter your Instagram:</p>
            <input type="text" id="instagram" placeholder="@yourhandle" required>
            <button onclick="submitInstagram()">Get My Results</button>
            <p id="randomQuote"></p>
            <p>Share with 3 friends to compare your scores!</p>
            <button onclick="shareQuiz()">Share Now</button>
        </div>
    </div>

    <script>
    let currentQuestion = 0;
    const quizDiv = document.getElementById("quiz");

    function loadQuestion() {
        if (currentQuestion >= questions.length) {
            quizDiv.classList.add("hidden");
            document.getElementById("result").classList.remove("hidden");
            displayRandomQuote();
            return;
        }
        const qData = questions[currentQuestion];
        let qHTML = `<div class='question'>🔥 ${qData.q}</div><div class='options'>`;
        
        if (qData.q.includes("name")) {
            qHTML += `<input type='text' id='input${currentQuestion}' placeholder='${qData.a[0]}' required>`;
            qHTML += `<button onclick='nextQuestionText(${currentQuestion})'>Next</button>`;
        } else {
            qData.a.forEach((ans, index) => {
                qHTML += `<button onclick='nextQuestion("${ans}")'>${ans}</button>`;
            });
        }
        
        qHTML += `</div>`;
        quizDiv.innerHTML = qHTML;
    }

    let answers = [];

    function nextQuestion(answer) {
        answers.push(answer);  // Store selected answer
        currentQuestion++;
        loadQuestion();
    }

    function nextQuestionText(qIndex) {
        const inputVal = document.getElementById(`input${qIndex}`).value;
        if (!inputVal) {
            alert("Please fill in the required field.");
            return;
        }

        if (qIndex === 0) {
            localStorage.setItem("userName", inputVal);
        }

        answers.push(inputVal);  // Store the answer
        currentQuestion++;
        loadQuestion();
    }

    function submitInstagram() {
        const name = localStorage.getItem("userName") || "Anonymous";
        const instaHandle = document.getElementById("instagram").value;

        if (!instaHandle) {
            alert("Please enter your Instagram handle to get results.");
            return;
        }

        fetch("https://script.google.com/macros/s/AKfycby-03skf43BQ1eS4xh8yivOn4L-4XkYQ6kPGhASL9XcnueWgNeuTPiNiniKtXvGJtzR/exec", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
                name: name,
                instagram: instaHandle,
                answers: answers
            })
        })
        .then(response => response.json())  // Expecting JSON response
        .then(data => {
            if (data.status === "success") {
                alert("✅ Success! Your results will be sent to @" + instaHandle);
            } else {
                alert("❌ Something went wrong. Please try again later.");
            }
        })
        .catch(error => {
            console.error("Error:", error);
            alert("⚠️ Unable to submit results. Check your internet and try again.");
        });
    }

    function shareQuiz() {
        alert("Share this quiz link with 3 friends to unlock more insights!");
    }

    function displayRandomQuote() {
        const quotes = [
            "🔥 You are wilder than you think! Keep embracing life!",
            "😎 Your secrets are safe with us! Stay mysterious!",
            "💖 Love, laughter, and a little bit of madness make life amazing!",
            "😉 Your past doesn’t define you, your courage does!",
            "😈 You’re full of surprises! Keep being your unapologetic self!"
        ];
        document.getElementById("randomQuote").innerText = quotes[Math.floor(Math.random() * quotes.length)];
    }

    loadQuestion();
</script>

</body>
</html>
